L.Control.Fullscreen=L.Control.extend({options:{position:"topleft",fullscreenNative:!0},onAdd:function(){var t="leaflet-control-zoom leaflet-bar leaflet-control",e=L.DomUtil.create("div",t);return this._createButton("&#10064;","Toggle fullscreen","leaflet-control-fullscreen leaflet-bar-part leaflet-bar-part-top-and-bottom",e,this._toogleFullScreen),e},_createButton:function(t,e,i,n,o){var s=L.DomUtil.create("a",i,n),a=L.Control.Fullscreen.api;return s.innerHTML=t,s.href="#",s.title=e,L.DomEvent.on(s,"click",L.DomEvent.stopPropagation).on(s,"click",L.DomEvent.preventDefault).on(s,"click",o,this).on(s,"dblclick",L.DomEvent.stopPropagation),L.DomEvent.addListener(n,a.fullScreenEventName,L.DomEvent.stopPropagation).addListener(n,a.fullScreenEventName,L.DomEvent.preventDefault).addListener(n,a.fullScreenEventName,this._handleEscKey,this),L.DomEvent.addListener(document,a.fullScreenEventName,L.DomEvent.stopPropagation).addListener(document,a.fullScreenEventName,L.DomEvent.preventDefault).addListener(document,a.fullScreenEventName,this._handleEscKey,this),this.options.fullscreenNative&&!a.supportsFullScreen&&L.DomEvent.addListener(document,"keydown",this._onKeyDown,this),s},_toogleFullScreen:function(){var t=this._map,e=t._container,i=L.Control.Fullscreen.api;this.options.fullscreenNative&&i.supportsFullScreen?i.isFullScreen(e)?(i.cancelFullScreen(e),L.DomUtil.removeClass(this._container,"leaflet-control-fullscreen-on"),t.fire("exitFullscreen")):(i.requestFullScreen(e),L.DomUtil.addClass(this._container,"leaflet-control-fullscreen-on"),t.fire("enterFullscreen")):L.DomUtil.hasClass(e,"leaflet-fullscreen")?(L.DomUtil.removeClass(e,"leaflet-fullscreen"),L.DomUtil.removeClass(this._container,"leaflet-control-fullscreen-on"),t.fire("exitFullscreen")):(L.DomUtil.addClass(e,"leaflet-fullscreen"),L.DomUtil.addClass(this._container,"leaflet-control-fullscreen-on"),t.fire("enterFullscreen")),t.invalidateSize()},_handleEscKey:function(){var t=this._map,e=L.Control.Fullscreen.api;e.isFullScreen(t)||(L.DomUtil.removeClass(this._container,"leaflet-control-fullscreen-on"),t.fire("exitFullscreen"),t.invalidateSize())},_onKeyDown:function(t){if(27==t.keyCode){var e=this._map,i=e._container;L.DomUtil.hasClass(i,"leaflet-fullscreen")&&(L.DomUtil.removeClass(i,"leaflet-fullscreen"),L.DomUtil.removeClass(this._container,"leaflet-control-fullscreen-on"),e.fire("exitFullscreen"),e.invalidateSize(),L.DomEvent.stop(t))}}}),L.Map.mergeOptions({fullscreenControl:!1,fullscreenNative:!0}),L.Map.addInitHook(function(){this.options.fullscreenControl&&(this.fullscreenControl=new L.Control.Fullscreen({fullscreenNative:this.options.fullscreenNative}),this.addControl(this.fullscreenControl))}),L.control.fullscreen=function(t){return new L.Control.Fullscreen(t)},L.Control.Fullscreen.api=function(){var t={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",prefix:""},e="webkit moz o ms khtml".split(" ");if("undefined"!=typeof document.cancelFullScreen)t.supportsFullScreen=!0;else for(var i=0;i<e.length;i++)if(t.prefix=e[i],"undefined"!=typeof document[t.prefix+"CancelFullScreen"]){t.supportsFullScreen=!0;break}return t.supportsFullScreen&&(t.fullScreenEventName=t.prefix+"fullscreenchange",t.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},t.requestFullScreen=function(t){return""===this.prefix?t.requestFullScreen():t[this.prefix+"RequestFullScreen"]()},t.cancelFullScreen=function(){return""===this.prefix?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()}),t}();